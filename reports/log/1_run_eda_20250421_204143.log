2025-04-21 20:41:43.249 | INFO     | electricitydemand.utils.log_utils:setup_logger:142 - 文本日志将写入：/home/ubuntu/ElectricityDemand/logs/1_run_eda_20250421_204143.log
2025-04-21 20:41:43.249 | INFO     | electricitydemand.utils.log_utils:setup_logger:180 - 已拦截标准库 logging。
2025-04-21 20:41:43.249 | INFO     | electricitydemand.utils.log_utils:setup_logger:185 - 已设置全局异常处理钩子 (sys.excepthook)。
2025-04-21 20:41:43.249 | INFO     | electricitydemand.utils.log_utils:setup_logger:187 - Loguru 初始化完成。默认级别：INFO. 控制台：INFO. 文件：INFO.
2025-04-21 20:41:43.249 | WARNING  | electricitydemand.utils.log_utils:setup_logger:190 - Diagnose 和 Backtrace 已启用。注意：在生产环境中 'diagnose=True' 可能泄露敏感数据！
2025-04-21 20:41:43.249 | INFO     | __main__:<module>:36 - 项目根目录: /home/ubuntu/ElectricityDemand
2025-04-21 20:41:43.250 | INFO     | __main__:<module>:37 - 数据目录: /home/ubuntu/ElectricityDemand/data
2025-04-21 20:41:43.250 | INFO     | __main__:<module>:38 - 日志目录: /home/ubuntu/ElectricityDemand/logs
2025-04-21 20:41:43.250 | INFO     | __main__:<module>:39 - 图表目录: /home/ubuntu/ElectricityDemand/plots
2025-04-21 20:41:43.568 | INFO     | __main__:run_all_eda:86 - =========================================
2025-04-21 20:41:43.568 | INFO     | __main__:run_all_eda:87 - ===     开始执行 Spark EDA 脚本       ===
2025-04-21 20:41:43.568 | INFO     | __main__:run_all_eda:88 - =========================================
2025-04-21 20:41:43.568 | INFO     | __main__:run_all_eda:95 - 创建 SparkSession...
2025-04-21 20:41:43.569 | INFO     | electricitydemand.utils.project_utils:create_spark_session:89 - Creating SparkSession for app: ElectricityDemandEDA...
2025-04-21 20:41:43.571 | INFO     | electricitydemand.utils.project_utils:create_spark_session:98 - System resources: 48 physical cores, 96 logical cores, 184.97 GB total memory, 180.53 GB available memory
2025-04-21 20:41:43.572 | INFO     | electricitydemand.utils.project_utils:create_spark_session:124 - Calculated resources -> Driver: 64GB/4 cores, Executor: 64GB/4 cores, Default parallelism: 92
2025-04-21 20:41:46.629 | SUCCESS  | electricitydemand.utils.project_utils:create_spark_session:175 - SparkSession created successfully.
2025-04-21 20:41:46.631 | INFO     | electricitydemand.utils.project_utils:create_spark_session:176 - Spark Web UI: http://172.21.0.13:4040
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:180 - Spark configuration:
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.dynamicAllocation.minExecutors = 1
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.driver.cores = 4
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.app.id = local-1745239305647
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.app.submitTime = 1745239304929
2025-04-21 20:41:46.648 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.driver.port = 34985
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.executor.cores = 4
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.default.parallelism = 92
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.executor.memory = 64g
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.serializer.objectStreamReset = 100
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.dynamicAllocation.initialExecutors = 1
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.master = local[*]
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.submit.deployMode = client
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.sql.execution.arrow.pyspark.enabled = true
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.memory.storageFraction = 0.3
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.driver.extraJavaOptions = -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false
2025-04-21 20:41:46.649 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.app.name = ElectricityDemandEDA
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.driver.host = 172.21.0.13
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.sql.warehouse.dir = file:/home/ubuntu/ElectricityDemand/spark-warehouse
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.shuffle.service.enabled = true
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.memory.fraction = 0.8
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.sql.adaptive.enabled = true
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.executor.id = driver
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.sql.adaptive.coalescePartitions.enabled = true
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.driver.memory = 64g
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.executor.memoryOverhead = 6553m
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.rdd.compress = True
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.executor.extraJavaOptions = -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.dynamicAllocation.maxExecutors = 24
2025-04-21 20:41:46.650 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.submit.pyFiles = 
2025-04-21 20:41:46.651 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.dynamicAllocation.enabled = true
2025-04-21 20:41:46.651 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.ui.showConsoleProgress = true
2025-04-21 20:41:46.651 | INFO     | electricitydemand.utils.project_utils:create_spark_session:182 -   spark.app.startTime = 1745239305026
2025-04-21 20:41:46.651 | INFO     | __main__:run_all_eda:103 - SparkSession 创建成功。
2025-04-21 20:41:46.651 | INFO     | __main__:run_all_eda:104 - Spark Web UI: http://172.21.0.13:4040
2025-04-21 20:41:46.651 | INFO     | __main__:run_all_eda:107 - --- 步骤 1: 加载数据 (Spark) ---
2025-04-21 20:41:46.651 | INFO     | electricitydemand.eda.load_data:load_datasets:37 - --- 开始使用 Spark 加载数据集 ---
2025-04-21 20:41:46.652 | INFO     | electricitydemand.eda.load_data:load_datasets:45 - Demand path: /home/ubuntu/ElectricityDemand/data/demand_converted.parquet
2025-04-21 20:41:46.652 | INFO     | electricitydemand.eda.load_data:load_datasets:46 - Metadata path: /home/ubuntu/ElectricityDemand/data/metadata.parquet
2025-04-21 20:41:46.652 | INFO     | electricitydemand.eda.load_data:load_datasets:47 - Weather path: /home/ubuntu/ElectricityDemand/data/weather_converted.parquet
2025-04-21 20:41:46.652 | INFO     | electricitydemand.eda.load_data:load_datasets:50 - 加载 Demand 数据: /home/ubuntu/ElectricityDemand/data/demand_converted.parquet
2025-04-21 20:41:48.056 | WARNING  | electricitydemand.eda.load_data:load_datasets:56 - Demand 'timestamp' 列不是 TimestampType，尝试转换...
2025-04-21 20:41:48.118 | INFO     | electricitydemand.eda.load_data:load_datasets:60 - Demand 'timestamp' 转换后类型: TimestampType()
2025-04-21 20:41:48.118 | INFO     | electricitydemand.eda.load_data:log_sdf_info:24 - Demand DataFrame - Schema:
2025-04-21 20:41:50.002 | INFO     | electricitydemand.eda.load_data:log_sdf_info:27 - Demand DataFrame - Count: 237,944,171
2025-04-21 20:41:50.002 | INFO     | electricitydemand.eda.load_data:load_datasets:69 - 加载 Metadata 数据: /home/ubuntu/ElectricityDemand/data/metadata.parquet
2025-04-21 20:41:50.059 | INFO     | electricitydemand.eda.load_data:log_sdf_info:24 - Metadata DataFrame - Schema:
2025-04-21 20:41:50.140 | INFO     | electricitydemand.eda.load_data:log_sdf_info:27 - Metadata DataFrame - Count: 7,572
2025-04-21 20:41:50.141 | INFO     | electricitydemand.eda.load_data:load_datasets:79 - 加载 Weather 数据: /home/ubuntu/ElectricityDemand/data/weather_converted.parquet
2025-04-21 20:41:50.205 | WARNING  | electricitydemand.eda.load_data:load_datasets:85 - Weather 'timestamp' 列不是 TimestampType，尝试转换...
2025-04-21 20:41:50.222 | INFO     | electricitydemand.eda.load_data:load_datasets:88 - Weather 'timestamp' 转换后类型: TimestampType()
2025-04-21 20:41:50.222 | INFO     | electricitydemand.eda.load_data:log_sdf_info:24 - Weather DataFrame - Schema:
2025-04-21 20:41:50.308 | INFO     | electricitydemand.eda.load_data:log_sdf_info:27 - Weather DataFrame - Count: 604,848
2025-04-21 20:41:50.309 | INFO     | electricitydemand.eda.load_data:load_datasets:95 - --- Spark 数据集加载完成 ---
2025-04-21 20:41:50.309 | INFO     | __main__:run_all_eda:112 - 数据集加载成功。
2025-04-21 20:41:50.365 | INFO     | __main__:run_all_eda:118 - Demand Schema:
2025-04-21 20:41:58.236 | INFO     | __main__:run_all_eda:120 - Demand Count: 237,944,171
2025-04-21 20:41:58.236 | INFO     | __main__:run_all_eda:121 - Metadata Schema:
2025-04-21 20:41:58.372 | INFO     | __main__:run_all_eda:123 - Metadata Count: 7,572
2025-04-21 20:41:58.372 | INFO     | __main__:run_all_eda:124 - Weather Schema:
2025-04-21 20:42:00.116 | INFO     | __main__:run_all_eda:126 - Weather Count: 604,848
2025-04-21 20:42:00.116 | INFO     | __main__:run_all_eda:129 - --- 步骤 2: 单变量分析 ---
2025-04-21 20:42:00.116 | INFO     | __main__:run_all_eda:130 - --- 开始 Demand 分析 (Spark) ---
2025-04-21 20:42:00.116 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:24 - --- 开始使用 Spark 分析 Demand 'y' 列分布 (抽样比例: 0.5%) ---
2025-04-21 20:42:00.117 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:38 - 使用 Spark 计算 'y' 列的描述性统计...
2025-04-21 20:42:23.560 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:57 - 'y' 列 (Spark 全量统计) 描述性统计:
count     2.348579e+08
mean      4.490447e+01
stddev    3.942504e+02
min       0.000000e+00
25%       7.700000e-02
50%       1.990000e-01
75%       7.633588e+00
max       2.212280e+05
2025-04-21 20:42:23.739 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:69 - 全量数据中 'y' 的总行数: 237,944,171
2025-04-21 20:42:23.739 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:70 - 全量数据中 'y' 非空数量: 234,857,893
2025-04-21 20:42:23.740 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:73 - 全量数据中 'y' 缺失数量: 3,086,278 (1.30%)
2025-04-21 20:42:23.740 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:78 - 使用 Spark 检查 'y' 列中的非正值 (<= 0)...
2025-04-21 20:42:24.641 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:83 - 全量数据中 'y' 缺失的数量: 3,086,278
2025-04-21 20:42:24.641 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:86 - 全量数据中 'y' <= 0 的数量 (在非缺失值中): 2,499,640 (1.06%)
2025-04-21 20:42:24.641 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:94 - 对 'y' 列进行 Spark 抽样 (比例: 0.5%) 以便绘图...
2025-04-21 20:42:24.653 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:101 - 将抽样结果收集到 Pandas Series...
2025-04-21 20:42:25.286 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_y_distribution:114 - 抽样并收集完成，得到 1,175,472 个非空样本 (Pandas)。
2025-04-21 20:42:25.287 | INFO     | electricitydemand.eda.analyze_demand:plot_demand_y_distribution:159 - 绘制 'y' 分布图 (样本比例: 0.5%)...
2025-04-21 20:42:25.295 | INFO     | electricitydemand.utils.eda_utils:plot_numerical_distribution:55 - Plotting distribution for column '/home/ubuntu/ElectricityDemand/plots' (Sample size: 1,175,472)...
2025-04-21 20:45:57.227 | ERROR    | electricitydemand.utils.eda_utils:save_plot:32 - Error saving plot 'Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Original Scale, Sample).png': [Errno 2] No such file or directory: 'demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Original Scale, Sample).png'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 131, in run_all_eda
    analyze_demand_y_distribution(
    └ <function analyze_demand_y_distribution at 0x748dea5eade0>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_demand.py", line 123, in analyze_demand_y_distribution
    plot_demand_y_distribution(
    └ <function plot_demand_y_distribution at 0x748de0fd6a20>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_demand.py", line 166, in plot_demand_y_distribution
    plot_numerical_distribution(y_sample.dropna(), col_name,
    │                           │        │         └ PosixPath('/home/ubuntu/ElectricityDemand/plots')
    │                           │        └ <function Series.dropna at 0x748deff5d940>
    │                           └ 0             0.132000
    │                             1             0.144000
    │                             2             0.199000
    │                             3             0.120000
    │                             4             0.099000
    │                                       ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/utils/eda_utils.py", line 79, in plot_numerical_distribution
    save_plot(fig, f"{filename_base}.png", plots_dir)  # Pass Path object
    │         │       │                    └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_orig')
    │         │       └ 'Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Original Scale, Sample)'
    │         └ <Figure size 1500x500 with 2 Axes>
    └ <function save_plot at 0x748de0fd6ac0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/utils/eda_utils.py", line 27, in save_plot
    fig.savefig(filepath)
    │   │       └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribu...
    │   └ <function Figure.savefig at 0x748de0fbe5c0>
    └ <Figure size 1500x500 with 2 Axes>

  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
    │    │      │            │        └ {'dpi': 'figure'}
    │    │      │            └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribu...
    │    │      └ <function FigureCanvasBase.print_figure at 0x748de2d653a0>
    │    └ <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748dfb1e16a0>
    └ <Figure size 1500x500 with 2 Axes>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             └ <function FigureCanvasAgg.print_png at 0x748d1340ec00>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                   │         │     │             │       │       └ <bound method FigureCanvasAgg.print_png of <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748dfb1e16a0>>
                   │         │     │             │       └ {'facecolor': None, 'edgecolor': None, 'orientation': 'portrait', 'bbox_inches_restore': None}
                   │         │     │             └ ('demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Ori...
                   │         │     └ <bound method FigureCanvasAgg.print_png of <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748dfb1e16a0>>
                   │         └ <function wraps at 0x748e7e761800>
                   └ <module 'functools' from '/home/ubuntu/.rye/py/cpython@3.12.4/lib/python3.12/functools.py'>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
    │    │          │                       │           └ None
    │    │          │                       └ None
    │    │          └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Orig...
    │    └ <function FigureCanvasAgg._print_pil at 0x748dfb1e5ee0>
    └ <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748dfb1e16a0>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
    │   │     └ <function imsave at 0x748de2d8cf40>
    │   └ <module 'matplotlib.image' from '/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/image.py'>
    └ <module 'matplotlib' from '/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/__init__.py'>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1644, in imsave
    image.save(fname, **pil_kwargs)
    │     │    │        └ {'pnginfo': <PIL.PngImagePlugin.PngInfo object at 0x748d12a9b170>, 'format': 'png', 'dpi': (100.0, 100.0)}
    │     │    └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Orig...
    │     └ <function Image.save at 0x748de9135ee0>
    └ <PIL.Image.Image image mode=RGBA size=1500x500 at 0x748DF976E300>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         │        │    └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Orig...
         │        └ <built-in function open>
         └ <module 'builtins' (built-in)>

FileNotFoundError: [Errno 2] No such file or directory: 'demand_/home/ubuntu/ElectricityDemand/plots_dist_orig/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Original Scale, Sample).png'
2025-04-21 20:45:57.254 | INFO     | electricitydemand.utils.eda_utils:plot_numerical_distribution:55 - Plotting distribution for column '/home/ubuntu/ElectricityDemand/plots (log1p)' (Sample size: 1,175,472)...
2025-04-21 20:46:02.455 | ERROR    | electricitydemand.utils.eda_utils:save_plot:32 - Error saving plot 'Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log1p Scale, Sample).png': [Errno 2] No such file or directory: 'demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log1p Scale, Sample).png'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 131, in run_all_eda
    analyze_demand_y_distribution(
    └ <function analyze_demand_y_distribution at 0x748dea5eade0>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_demand.py", line 123, in analyze_demand_y_distribution
    plot_demand_y_distribution(
    └ <function plot_demand_y_distribution at 0x748de0fd6a20>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_demand.py", line 174, in plot_demand_y_distribution
    plot_numerical_distribution(y_log_sample, f'{col_name} (log1p)',
    │                           │                └ PosixPath('/home/ubuntu/ElectricityDemand/plots')
    │                           └ 0          0.123986
    │                             1          0.134531
    │                             2          0.181488
    │                             3          0.113329
    │                             4          0.094401
    │                                          ...   
    │                             11754...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/utils/eda_utils.py", line 79, in plot_numerical_distribution
    save_plot(fig, f"{filename_base}.png", plots_dir)  # Pass Path object
    │         │       │                    └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p')
    │         │       └ 'Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log1p Scale, Sample)'
    │         └ <Figure size 1500x500 with 2 Axes>
    └ <function save_plot at 0x748de0fd6ac0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/utils/eda_utils.py", line 27, in save_plot
    fig.savefig(filepath)
    │   │       └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distrib...
    │   └ <function Figure.savefig at 0x748de0fbe5c0>
    └ <Figure size 1500x500 with 2 Axes>

  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
    │    │      │            │        └ {'dpi': 'figure'}
    │    │      │            └ PosixPath('demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distrib...
    │    │      └ <function FigureCanvasBase.print_figure at 0x748de2d653a0>
    │    └ <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748d12ae8980>
    └ <Figure size 1500x500 with 2 Axes>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             └ <function FigureCanvasAgg.print_png at 0x748d0eaf5b20>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                   │         │     │             │       │       └ <bound method FigureCanvasAgg.print_png of <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748d12ae8980>>
                   │         │     │             │       └ {'facecolor': None, 'edgecolor': None, 'orientation': 'portrait', 'bbox_inches_restore': None}
                   │         │     │             └ ('demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Lo...
                   │         │     └ <bound method FigureCanvasAgg.print_png of <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748d12ae8980>>
                   │         └ <function wraps at 0x748e7e761800>
                   └ <module 'functools' from '/home/ubuntu/.rye/py/cpython@3.12.4/lib/python3.12/functools.py'>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
    │    │          │                       │           └ None
    │    │          │                       └ None
    │    │          └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log...
    │    └ <function FigureCanvasAgg._print_pil at 0x748dfb1e5ee0>
    └ <matplotlib.backends.backend_agg.FigureCanvasAgg object at 0x748d12ae8980>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
    │   │     └ <function imsave at 0x748de2d8cf40>
    │   └ <module 'matplotlib.image' from '/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/image.py'>
    └ <module 'matplotlib' from '/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/__init__.py'>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1644, in imsave
    image.save(fname, **pil_kwargs)
    │     │    │        └ {'pnginfo': <PIL.PngImagePlugin.PngInfo object at 0x748d0cebacf0>, 'format': 'png', 'dpi': (100.0, 100.0)}
    │     │    └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log...
    │     └ <function Image.save at 0x748de9135ee0>
    └ <PIL.Image.Image image mode=RGBA size=1500x500 at 0x748D0E9AEB70>
  File "/home/ubuntu/ElectricityDemand/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         │        │    └ 'demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log...
         │        └ <built-in function open>
         └ <module 'builtins' (built-in)>

FileNotFoundError: [Errno 2] No such file or directory: 'demand_/home/ubuntu/ElectricityDemand/plots_dist_log1p/Demand Value (/home/ubuntu/ElectricityDemand/plots) Distribution (Log1p Scale, Sample).png'
2025-04-21 20:46:02.461 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_timeseries_sample:189 - --- Starting analysis of Demand time series (sampling 3 unique_id) ---
2025-04-21 20:46:02.470 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:507 - Starting Spark ID sampling and collection for column 'unique_id'...
2025-04-21 20:46:02.470 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:532 - Getting distinct 'unique_id' values from Spark DataFrame...
2025-04-21 20:46:07.328 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:551 - Randomly sampling 3 'unique_id' values using Spark RDD takeSample...
2025-04-21 20:46:09.888 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:562 - Selected 3 IDs (first 5): ['8ce0b05f1eed00a4', 'aaad8381da7e4232', '99d59d79d2e2a966']
2025-04-21 20:46:09.889 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:566 - Filtering Spark DataFrame for selected IDs in 'unique_id'...
2025-04-21 20:46:09.922 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:572 - Selecting columns ['unique_id', 'timestamp', 'y'] and collecting filtered data to Pandas...
2025-04-21 20:46:11.058 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:581 - Pandas DataFrame collected, containing 109,740 rows for 3 IDs.
2025-04-21 20:46:11.058 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:607 - Sorting Pandas DataFrame by ['unique_id', 'timestamp']...
2025-04-21 20:46:11.078 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:632 - Spark ID sampling, collection, and initial Pandas processing complete.
2025-04-21 20:46:11.079 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_timeseries_sample:226 - Starting to plot time series for each sample (in Pandas) and analyze frequency...
2025-04-21 20:46:11.396 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/timeseries_sample_8ce0b05f1eed00a4.png
2025-04-21 20:46:11.620 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- unique_id: 8ce0b05f1eed00a4 Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:11.621 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID 8ce0b05f1eed00a4 Interval 值分布 ---
2025-04-21 20:46:11.623 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
36590   1    100.0
2025-04-21 20:46:11.624 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID 8ce0b05f1eed00a4 Interval' 值计数中未发现 NaN。
2025-04-21 20:46:11.625 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID 8ce0b05f1eed00a4 Interval' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:11.625 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:11.899 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/timeseries_sample_99d59d79d2e2a966.png
2025-04-21 20:46:12.032 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- unique_id: 99d59d79d2e2a966 Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:12.033 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID 99d59d79d2e2a966 Interval 值分布 ---
2025-04-21 20:46:12.034 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
34677   1    100.0
2025-04-21 20:46:12.035 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID 99d59d79d2e2a966 Interval' 值计数中未发现 NaN。
2025-04-21 20:46:12.035 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID 99d59d79d2e2a966 Interval' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:12.035 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:12.257 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/timeseries_sample_aaad8381da7e4232.png
2025-04-21 20:46:12.502 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- unique_id: aaad8381da7e4232 Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:12.503 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID aaad8381da7e4232 Interval 值分布 ---
2025-04-21 20:46:12.505 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
38470   1    100.0
2025-04-21 20:46:12.506 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID aaad8381da7e4232 Interval' 值计数中未发现 NaN。
2025-04-21 20:46:12.507 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID aaad8381da7e4232 Interval' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:12.508 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:12.509 | INFO     | electricitydemand.eda.analyze_demand:analyze_demand_timeseries_sample:266 - Demand time series sample analysis complete.
2025-04-21 20:46:12.509 | INFO     | __main__:run_all_eda:135 - --- 完成 Demand 分析 (Spark) ---
2025-04-21 20:46:12.510 | INFO     | __main__:run_all_eda:138 - --- 开始 Metadata 分析 (Spark DF -> Pandas DF) ---
2025-04-21 20:46:12.510 | INFO     | __main__:run_all_eda:139 - 将 Metadata Spark DataFrame 转换为 Pandas DataFrame...
2025-04-21 20:46:12.699 | INFO     | __main__:run_all_eda:143 - Metadata Pandas DataFrame 转换成功，形状: (7572, 11)
2025-04-21 20:46:12.704 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:25 - --- 分析 Metadata 分类特征 ---
2025-04-21 20:46:12.704 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:32 - --- 分析列: dataset ---
2025-04-21 20:46:12.705 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:36 - 值分布 (Top 10):
dataset
London Smart Meter Data      5566
Building Data Genome 2       1636
Electricity Load Diagrams     370
2025-04-21 20:46:12.708 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:32 - --- 分析列: location ---
2025-04-21 20:46:12.708 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:36 - 值分布 (Top 10):
location
London, UK                     5634
PT                              370
Washington DC, USA              305
None                            237
Minneapolis, Minnesota, USA     163
Cardiff, UK                     147
Phoenix, Arizona, USA           137
Orlando, Florida, USA           136
Ithaca, New York, USA           124
Austin, Texas, USA              124
2025-04-21 20:46:12.709 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:38 - ... (共 14 个唯一值)
2025-04-21 20:46:12.710 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:32 - --- 分析列: timezone ---
2025-04-21 20:46:12.712 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:36 - 值分布 (Top 10):
timezone
Europe/London    5781
US/Eastern        812
Europe/Lisbon     370
US/Central        287
US/Mountain       173
US/Pacific        113
Europe/Dublin      36
2025-04-21 20:46:12.712 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:32 - --- 分析列: freq ---
2025-04-21 20:46:12.713 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:36 - 值分布 (Top 10):
freq
30T    5566
1H     1636
15T     370
2025-04-21 20:46:12.713 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:32 - --- 分析列: building_class ---
2025-04-21 20:46:12.718 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:36 - 值分布 (Top 10):
building_class
Residential    5936
Commercial     1636
2025-04-21 20:46:12.718 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_categorical:41 - --- 完成 Metadata 分类特征分析 ---
2025-04-21 20:46:12.719 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:52 - --- 绘制 Metadata 分类特征分布图 ---
2025-04-21 20:46:12.719 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:65 - 绘制 'dataset' 的分布图 (共 3 个唯一值)...
2025-04-21 20:46:12.897 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:99 - 图表已保存: /home/ubuntu/ElectricityDemand/plots/metadata_dist_dataset.png
2025-04-21 20:46:12.897 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:65 - 绘制 'location' 的分布图 (共 14 个唯一值)...
2025-04-21 20:46:13.105 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:99 - 图表已保存: /home/ubuntu/ElectricityDemand/plots/metadata_dist_location.png
2025-04-21 20:46:13.105 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:65 - 绘制 'timezone' 的分布图 (共 7 个唯一值)...
2025-04-21 20:46:13.352 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:99 - 图表已保存: /home/ubuntu/ElectricityDemand/plots/metadata_dist_timezone.png
2025-04-21 20:46:13.356 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:65 - 绘制 'freq' 的分布图 (共 3 个唯一值)...
2025-04-21 20:46:13.395 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:46:13.426 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:46:13.668 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:99 - 图表已保存: /home/ubuntu/ElectricityDemand/plots/metadata_dist_freq.png
2025-04-21 20:46:13.669 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:65 - 绘制 'building_class' 的分布图 (共 2 个唯一值)...
2025-04-21 20:46:13.747 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:99 - 图表已保存: /home/ubuntu/ElectricityDemand/plots/metadata_dist_building_class.png
2025-04-21 20:46:13.747 | INFO     | electricitydemand.eda.analyze_metadata:plot_metadata_categorical:104 - --- 完成 Metadata 分类特征分布图绘制 ---
2025-04-21 20:46:13.748 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:115 - --- 分析 Metadata 数值特征 ---
2025-04-21 20:46:13.755 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:128 - 数值特征描述性统计:
          latitude    longitude  cluster_size
count  7335.000000  7335.000000        7572.0
mean     48.755646   -14.083789           1.0
std       5.873737    33.140486           0.0
min      28.520000  -122.260000           1.0
25%      51.520000    -0.130000           1.0
50%      51.520000    -0.130000           1.0
75%      51.520000    -0.130000           1.0
max      53.350000     6.260000           1.0
2025-04-21 20:46:13.928 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:147 - 'latitude' 直方图已保存: /home/ubuntu/ElectricityDemand/plots/metadata_hist_latitude.png
2025-04-21 20:46:14.108 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:147 - 'longitude' 直方图已保存: /home/ubuntu/ElectricityDemand/plots/metadata_hist_longitude.png
2025-04-21 20:46:14.273 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:147 - 'cluster_size' 直方图已保存: /home/ubuntu/ElectricityDemand/plots/metadata_hist_cluster_size.png
2025-04-21 20:46:14.407 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/metadata_location_scatter.png
2025-04-21 20:46:14.408 | INFO     | electricitydemand.eda.analyze_metadata:analyze_metadata_numerical:177 - --- 完成 Metadata 数值特征分析 ---
2025-04-21 20:46:14.409 | INFO     | electricitydemand.eda.analyze_metadata:analyze_missing_locations:189 - --- 开始分析 Metadata 中缺失的位置信息 ---
2025-04-21 20:46:14.411 | INFO     | electricitydemand.eda.analyze_metadata:analyze_missing_locations:207 - 发现 237 行的所有位置信息 (location_id, latitude, longitude, location) 均为缺失。
2025-04-21 20:46:14.415 | INFO     | electricitydemand.eda.analyze_metadata:analyze_missing_locations:214 - 缺失位置信息的行 (前 5 行):
                                 dataset             building_id location_id  latitude  longitude location    timezone building_class  cluster_size freq
unique_id                                                                                                                                               
af7d0992308ddcbf  Building Data Genome 2     Gator_office_Carrie        None       NaN        NaN     None  US/Eastern     Commercial             1   1H
647d0556e538682a  Building Data Genome 2       Gator_office_Lucy        None       NaN        NaN     None  US/Eastern     Commercial             1   1H
84be3f18f01d3ddb  Building Data Genome 2    Gator_assembly_Lelia        None       NaN        NaN     None  US/Eastern     Commercial             1   1H
0bafabde1547223b  Building Data Genome 2    Gator_other_Elfriede        None       NaN        NaN     None  US/Eastern     Commercial             1   1H
e2cae95c19389c9d  Building Data Genome 2  Gator_assembly_Maurine        None       NaN        NaN     None  US/Eastern     Commercial             1   1H
2025-04-21 20:46:14.415 | INFO     | electricitydemand.eda.analyze_metadata:analyze_missing_locations:215 - 分析缺失位置信息行的其他特征分布:
2025-04-21 20:46:14.416 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：(缺失位置) dataset 值分布 ---
2025-04-21 20:46:14.418 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
                         计数  百分比 (%)
dataset                             
Building Data Genome 2  237    100.0
2025-04-21 20:46:14.419 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 '(缺失位置) dataset' 值计数中未发现 NaN。
2025-04-21 20:46:14.419 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 '(缺失位置) dataset' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:14.419 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:14.420 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：(缺失位置) building_class 值分布 ---
2025-04-21 20:46:14.422 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
                 计数  百分比 (%)
building_class              
Commercial      237    100.0
2025-04-21 20:46:14.422 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 '(缺失位置) building_class' 值计数中未发现 NaN。
2025-04-21 20:46:14.423 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 '(缺失位置) building_class' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:14.423 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:14.424 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：(缺失位置) freq 值分布 ---
2025-04-21 20:46:14.425 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
freq              
1H    237    100.0
2025-04-21 20:46:14.426 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 '(缺失位置) freq' 值计数中未发现 NaN。
2025-04-21 20:46:14.426 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 '(缺失位置) freq' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:14.427 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:14.427 | INFO     | electricitydemand.eda.analyze_metadata:analyze_missing_locations:232 - 缺失位置信息分析完成。
2025-04-21 20:46:14.427 | INFO     | __main__:run_all_eda:166 - --- 完成 Metadata 分析 ---
2025-04-21 20:46:14.428 | INFO     | __main__:run_all_eda:173 - --- 开始 Weather 分析 (Spark) ---
2025-04-21 20:46:14.428 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:59 - --- 开始分析 Weather 数值特征分布 (Spark) ---
2025-04-21 20:46:14.428 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:87 - 使用 Spark 计算数值特征的描述性统计...
2025-04-21 20:46:39.778 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:125 - Spark 计算的描述性统计:
        temperature_2m  relative_humidity_2m   dew_point_2m  apparent_temperature  precipitation           rain       snowfall     snow_depth   pressure_msl  surface_pressure    cloud_cover  cloud_cover_low  cloud_cover_mid  cloud_cover_high  et0_fao_evapotranspiration  vapour_pressure_deficit  wind_speed_10m  wind_direction_10m  wind_gusts_10m  soil_temperature_0_to_7cm  soil_temperature_7_to_28cm  soil_moisture_0_to_7cm  soil_moisture_7_to_28cm  sunshine_duration  shortwave_radiation  direct_radiation  diffuse_radiation  direct_normal_irradiance  terrestrial_radiation
count    604848.000000         604848.000000  604848.000000         604848.000000  604848.000000  604848.000000  604848.000000  604848.000000  604848.000000     604848.000000  604848.000000    604848.000000    604848.000000     604848.000000               604848.000000            604848.000000   604848.000000       604848.000000   604848.000000              604848.000000               604848.000000           604848.000000            604848.000000      604848.000000        604848.000000     604848.000000      604848.000000             604848.000000          604848.000000
mean         13.043232             72.994254       7.469432             11.199999       0.104439       0.098115       0.004602       0.016962    1016.344055       1005.593240      47.802610        31.496008        26.783263         35.679511                    0.110859                 0.575833       12.791896          197.332483       26.637381                  14.073293                   14.007569                0.312330                 0.320900        1230.290619           160.496367        103.807467          56.688900                186.054919             314.664655
stddev        9.862261             19.791132       9.148833             11.900755       0.483059       0.476445       0.055332       0.068546       8.433961         14.500265      37.891868        38.231071        35.325166         41.178399                    0.156858                 0.831642        6.774915           96.776903       13.148384                   9.628982                    8.727776                0.123079                 0.108136        1646.818797           241.076100        188.234869          77.751038                279.753732             398.050797
min         -32.200001              2.582063     -36.099998            -37.681385       0.000000       0.000000       0.000000       0.000000     970.599976        952.082153       0.000000         0.000000         0.000000          0.000000                    0.000000                 0.000000        0.000000            0.440730        1.440000                 -20.711000                  -15.361000                0.000000                 0.027000           0.000000             0.000000          0.000000           0.000000                  0.000000               0.000000
25%           6.997500             61.176437       2.283000              3.391027       0.000000       0.000000       0.000000       0.000000    1011.700012        997.936157      10.200001         0.000000         0.000000          0.000000                    0.006063                 0.125121        7.787991          120.256355       16.559999                   7.226500                    7.603000                0.238000                 0.244000           0.000000             0.000000          0.000000           0.000000                  0.000000               0.000000
50%          13.326500             77.333199       8.600000             11.259665       0.000000       0.000000       0.000000       0.000000    1016.500000       1008.601440      41.099998        10.000000         6.000000          9.000000                    0.038774                 0.285856       11.585320          211.660706       24.480000                  13.926500                   14.176500                0.341000                 0.340000           0.000000             7.000000          0.000000           6.000000                  0.000000              51.724712
75%          19.592499             88.814079      13.576500             19.278246       0.000000       0.000000       0.000000       0.000000    1021.400024       1015.447266      89.999992        64.000000        47.000000         84.000000                    0.151983                 0.671277       16.595179          273.012726       34.379997                  20.217499                   19.839500                0.400000                 0.400000        3600.000000           262.000000        122.000000         100.000000                333.468933             620.696228
max          47.613499            100.000000      27.320002             48.003006      33.000000      33.000000       4.270000       0.790000    1051.000000       1044.969727     100.000000       100.000000       100.000000        100.000000                    1.109937                10.356438       66.794312          360.000000      128.159988                  61.289501                   43.089500                0.520000                 0.520000        3600.000000          1079.000000        952.000000         488.000000               1017.039001            1318.578247
2025-04-21 20:46:39.780 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:138 - 使用 Spark 检查列 ['precipitation', 'rain', 'snowfall', 'snow_depth', 'et0_fao_evapotranspiration', 'sunshine_duration', 'direct_radiation', 'diffuse_radiation'] 中的负值...
2025-04-21 20:46:40.314 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'precipitation' 未检测到负值。
2025-04-21 20:46:40.674 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'rain' 未检测到负值。
2025-04-21 20:46:40.973 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'snowfall' 未检测到负值。
2025-04-21 20:46:41.222 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'snow_depth' 未检测到负值。
2025-04-21 20:46:41.568 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'et0_fao_evapotranspiration' 未检测到负值。
2025-04-21 20:46:41.881 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'sunshine_duration' 未检测到负值。
2025-04-21 20:46:42.129 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'direct_radiation' 未检测到负值。
2025-04-21 20:46:42.423 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:147 - 列 'diffuse_radiation' 未检测到负值。
2025-04-21 20:46:42.424 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:153 - 开始绘制 Weather 特征分布图 (抽样比例: 5.0%)...
2025-04-21 20:46:42.424 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: temperature_2m
2025-04-21 20:46:42.747 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'temperature_2m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'temperature_2m'
    │                           └ 0         4.126500
    │                             1         4.126500
    │                             2         0.826500
    │                             3         1.326500
    │                             4         3.376500
    │                                        ...    
    │                             30205    11...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:42.749 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: relative_humidity_2m
2025-04-21 20:46:42.880 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'relative_humidity_2m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'relative_humidity_2m'
    │                           └ 0        97.229843
    │                             1        94.527794
    │                             2        95.069229
    │                             3        94.405067
    │                             4        88.942139
    │                                        ...    
    │                             30205    84...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:42.881 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: dew_point_2m
2025-04-21 20:46:43.187 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'dew_point_2m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'dew_point_2m'
    │                           └ 0        3.726500
    │                             1        3.326500
    │                             2        0.126500
    │                             3        0.526500
    │                             4        1.726500
    │                                        ...   
    │                             30205    8.992500...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:43.190 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: apparent_temperature
2025-04-21 20:46:43.371 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'apparent_temperature' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'apparent_temperature'
    │                           └ 0         1.484439
    │                             1         1.022741
    │                             2        -2.833906
    │                             3        -1.546185
    │                             4         0.236538
    │                                        ...    
    │                             30205     8...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:43.377 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: precipitation
2025-04-21 20:46:43.612 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'precipitation' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'precipitation'
    │                           └ 0        0.0
    │                             1        0.0
    │                             2        0.0
    │                             3        0.0
    │                             4        0.0
    │                                     ... 
    │                             30205    0.0
    │                             30206    0.0
    │                             30207    0.0
    │                             30208   ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:43.614 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: rain
2025-04-21 20:46:43.856 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'rain' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'rain'
    │                           └ 0        0.0
    │                             1        0.0
    │                             2        0.0
    │                             3        0.0
    │                             4        0.0
    │                                     ... 
    │                             30205    0.0
    │                             30206    0.0
    │                             30207    0.0
    │                             30208   ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:43.858 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: snowfall
2025-04-21 20:46:44.072 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'snowfall' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'snowfall'
    │                           └ 0        0.0
    │                             1        0.0
    │                             2        0.0
    │                             3        0.0
    │                             4        0.0
    │                                     ... 
    │                             30205    0.0
    │                             30206    0.0
    │                             30207    0.0
    │                             30208   ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:44.074 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: snow_depth
2025-04-21 20:46:44.237 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'snow_depth' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'snow_depth'
    │                           └ 0        0.0
    │                             1        0.0
    │                             2        0.0
    │                             3        0.0
    │                             4        0.0
    │                                     ... 
    │                             30205    0.0
    │                             30206    0.0
    │                             30207    0.0
    │                             30208   ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:44.242 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: pressure_msl
2025-04-21 20:46:44.537 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'pressure_msl' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'pressure_msl'
    │                           └ 0        1025.699951
    │                             1        1024.300049
    │                             2        1027.599976
    │                             3        1015.599976
    │                             4        1013.400024
    │                                         ...     ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:44.545 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: surface_pressure
2025-04-21 20:46:44.772 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'surface_pressure' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'surface_pressure'
    │                           └ 0        1020.408630
    │                             1        1019.015930
    │                             2        1022.235107
    │                             3        1010.307556
    │                             4        1008.157959
    │                                         ...     ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:44.775 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: cloud_cover
2025-04-21 20:46:44.981 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'cloud_cover' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'cloud_cover'
    │                           └ 0         88.199997
    │                             1         90.000000
    │                             2         92.699997
    │                             3        100.000000
    │                             4        100.000000
    │                                         ...    
    │                             30205...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:44.983 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: cloud_cover_low
2025-04-21 20:46:45.215 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'cloud_cover_low' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'cloud_cover_low'
    │                           └ 0         98.0
    │                             1        100.0
    │                             2         61.0
    │                             3         97.0
    │                             4         35.0
    │                                      ...  
    │                             30205      0.0
    │                             30206      0.0
    │                             30207...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:45.224 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: cloud_cover_mid
2025-04-21 20:46:45.535 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'cloud_cover_mid' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'cloud_cover_mid'
    │                           └ 0         0.0
    │                             1         0.0
    │                             2        58.0
    │                             3         3.0
    │                             4        92.0
    │                                      ... 
    │                             30205     0.0
    │                             30206     0.0
    │                             30207     0.0...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:45.538 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: cloud_cover_high
2025-04-21 20:46:45.701 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'cloud_cover_high' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'cloud_cover_high'
    │                           └ 0         0.0
    │                             1         0.0
    │                             2        10.0
    │                             3        92.0
    │                             4        86.0
    │                                      ... 
    │                             30205    87.5
    │                             30206    80.0
    │                             30207    92.5...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:45.711 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: et0_fao_evapotranspiration
2025-04-21 20:46:46.140 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'et0_fao_evapotranspiration' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'et0_fao_evapotranspiration'
    │                           └ 0        0.000000
    │                             1        0.000000
    │                             2        0.000000
    │                             3        0.000000
    │                             4        0.042460
    │                                        ...   
    │                             30205    0.013313...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:46.144 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: vapour_pressure_deficit
2025-04-21 20:46:46.279 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'vapour_pressure_deficit' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'vapour_pressure_deficit'
    │                           └ 0        0.022793
    │                             1        0.045025
    │                             2        0.032086
    │                             3        0.037741
    │                             4        0.086306
    │                                        ...   
    │                             30205    0.209219...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:46.281 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: wind_speed_10m
2025-04-21 20:46:46.451 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'wind_speed_10m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'wind_speed_10m'
    │                           └ 0         7.993297
    │                             1        10.630672
    │                             2        10.661107
    │                             3         5.692100
    │                             4         8.891343
    │                                        ...    
    │                             30205    16...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:46.455 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: wind_direction_10m
2025-04-21 20:46:46.642 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'wind_direction_10m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'wind_direction_10m'
    │                           └ 0        305.837738
    │                             1        298.300659
    │                             2         11.689341
    │                             3        198.435043
    │                             4        211.759430
    │                                         ...    
    │                             30205...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:46.645 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: wind_gusts_10m
2025-04-21 20:46:46.875 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'wind_gusts_10m' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'wind_gusts_10m'
    │                           └ 0        14.759999
    │                             1        21.240000
    │                             2        19.440001
    │                             3        13.679999
    │                             4        16.559999
    │                                        ...    
    │                             30205    27...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:46.881 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: soil_temperature_0_to_7cm
2025-04-21 20:46:47.105 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'soil_temperature_0_to_7cm' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'soil_temperature_0_to_7cm'
    │                           └ 0         3.176500
    │                             1         3.126500
    │                             2         1.826500
    │                             3         0.126500
    │                             4         0.526500
    │                                        ...    
    │                             30205    11...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:47.114 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: soil_temperature_7_to_28cm
2025-04-21 20:46:47.306 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'soil_temperature_7_to_28cm' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'soil_temperature_7_to_28cm'
    │                           └ 0         3.1265
    │                             1         3.0265
    │                             2         3.1265
    │                             3         0.8765
    │                             4         0.8765
    │                                       ...   
    │                             30205    13.4925
    │                             30206 ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:47.321 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: soil_moisture_0_to_7cm
2025-04-21 20:46:47.766 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'soil_moisture_0_to_7cm' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'soil_moisture_0_to_7cm'
    │                           └ 0        0.3930
    │                             1        0.3930
    │                             2        0.3930
    │                             3        0.3830
    │                             4        0.3820
    │                                       ...  
    │                             30205    0.3470
    │                             30206    0.34...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:47.767 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: soil_moisture_7_to_28cm
2025-04-21 20:46:47.910 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'soil_moisture_7_to_28cm' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'soil_moisture_7_to_28cm'
    │                           └ 0        0.3930
    │                             1        0.3920
    │                             2        0.3920
    │                             3        0.3860
    │                             4        0.3850
    │                                       ...  
    │                             30205    0.3525
    │                             30206    0.35...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:47.916 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: sunshine_duration
2025-04-21 20:46:48.187 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'sunshine_duration' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'sunshine_duration'
    │                           └ 0        0.0
    │                             1        0.0
    │                             2        0.0
    │                             3        0.0
    │                             4        0.0
    │                                     ... 
    │                             30205    0.0
    │                             30206    0.0
    │                             30207    0.0
    │                             30208   ...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:48.195 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: shortwave_radiation
2025-04-21 20:46:48.431 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'shortwave_radiation' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'shortwave_radiation'
    │                           └ 0          0.0
    │                             1          0.0
    │                             2          0.0
    │                             3          0.0
    │                             4        122.0
    │                                      ...  
    │                             30205      0.0
    │                             30206      0.0
    │                             30207...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:48.437 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: direct_radiation
2025-04-21 20:46:48.642 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'direct_radiation' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'direct_radiation'
    │                           └ 0         0.0
    │                             1         0.0
    │                             2         0.0
    │                             3         0.0
    │                             4        14.0
    │                                      ... 
    │                             30205     0.0
    │                             30206     0.0
    │                             30207     0.0...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:48.647 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: diffuse_radiation
2025-04-21 20:46:48.803 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'diffuse_radiation' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'diffuse_radiation'
    │                           └ 0          0.0
    │                             1          0.0
    │                             2          0.0
    │                             3          0.0
    │                             4        108.0
    │                                      ...  
    │                             30205      0.0
    │                             30206      0.0
    │                             30207...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:48.810 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: direct_normal_irradiance
2025-04-21 20:46:49.034 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'direct_normal_irradiance' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'direct_normal_irradiance'
    │                           └ 0         0.000000
    │                             1         0.000000
    │                             2         0.000000
    │                             3         0.000000
    │                             4        53.138016
    │                                        ...    
    │                             30205     0...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:49.050 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:155 - 绘制列: terrestrial_radiation
2025-04-21 20:46:49.245 | ERROR    | electricitydemand.eda.analyze_weather:analyze_weather_numerical:179 - 绘制列 'terrestrial_radiation' 的分布图时出错: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
Traceback (most recent call last):

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 261, in <module>
    run_all_eda()  # 取消注释以运行
    └ <function run_all_eda at 0x748dea5eac00>

  File "/home/ubuntu/ElectricityDemand/src/electricitydemand/1_run_eda.py", line 175, in run_all_eda
    analyze_weather_numerical(
    └ <function analyze_weather_numerical at 0x748de0fd6ca0>

> File "/home/ubuntu/ElectricityDemand/src/electricitydemand/eda/analyze_weather.py", line 174, in analyze_weather_numerical
    plot_numerical_distribution(col_sample_pd, col,
    │                           │              └ 'terrestrial_radiation'
    │                           └ 0          0.000000
    │                             1          0.000000
    │                             2          0.000000
    │                             3          0.000000
    │                             4        372.699646
    │                                         ...    
    │                             30205...
    └ <function plot_numerical_distribution at 0x748ddfbd44a0>

TypeError: plot_numerical_distribution() got an unexpected keyword argument 'title_prefix'
2025-04-21 20:46:49.247 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_numerical:181 - Weather 数值特征分析完成。
2025-04-21 20:46:49.247 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:192 - --- 分析 Weather 分类特征 (Spark) ---
2025-04-21 20:46:49.247 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:198 - --- 分析列: is_day ---
2025-04-21 20:46:50.034 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:205 - 'is_day' 值分布 (Top 20):
 is_day  count
    1.0 307957
    0.0 296672
    0.5    219
2025-04-21 20:46:50.054 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:46:50.067 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:46:50.183 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:244 - 'is_day' 分布图已保存: /home/ubuntu/ElectricityDemand/plots/weather_dist_is_day.png
2025-04-21 20:46:50.183 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:198 - --- 分析列: weather_code ---
2025-04-21 20:46:50.718 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:205 - 'weather_code' 值分布 (Top 20):
 weather_code  count
          0.0 189824
          1.0 123921
          3.0 117225
          2.0  66923
         51.0  44892
         53.0  14586
         61.0   7727
         71.0   6788
          0.5   5861
         55.0   4226
         63.0   3884
         73.0   3729
          1.5   3656
          2.5   1701
         27.0   1515
         26.0   1491
         26.5   1384
         75.0    638
         52.0    621
         25.5    590
2025-04-21 20:46:50.719 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:208 - ... (共 41 个唯一值)
2025-04-21 20:46:50.993 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:244 - 'weather_code' 分布图已保存: /home/ubuntu/ElectricityDemand/plots/weather_dist_weather_code.png
2025-04-21 20:46:50.993 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_categorical:250 - --- 完成 Weather 分类特征分析 ---
2025-04-21 20:46:50.994 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_timeseries_sample:348 - --- Starting analysis of Weather time series frequency (sampling 3 location_id) ---
2025-04-21 20:46:51.000 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:507 - Starting Spark ID sampling and collection for column 'location_id'...
2025-04-21 20:46:51.000 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:532 - Getting distinct 'location_id' values from Spark DataFrame...
2025-04-21 20:46:51.311 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:551 - Randomly sampling 3 'location_id' values using Spark RDD takeSample...
2025-04-21 20:46:51.745 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:562 - Selected 3 IDs (first 5): ['gcpvj6btgb1d', 'gcpuvr295zcd', 'dr4vs1mpgc4v']
2025-04-21 20:46:51.745 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:566 - Filtering Spark DataFrame for selected IDs in 'location_id'...
2025-04-21 20:46:51.753 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:572 - Selecting columns ['location_id', 'timestamp'] and collecting filtered data to Pandas...
2025-04-21 20:46:52.319 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:581 - Pandas DataFrame collected, containing 105,192 rows for 3 IDs.
2025-04-21 20:46:52.319 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:607 - Sorting Pandas DataFrame by ['location_id', 'timestamp']...
2025-04-21 20:46:52.329 | INFO     | electricitydemand.utils.eda_utils:sample_spark_ids_and_collect:632 - Spark ID sampling, collection, and initial Pandas processing complete.
2025-04-21 20:46:52.330 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_timeseries_sample:381 - Starting to analyze weather timestamp frequency for each sample (in Pandas)...
2025-04-21 20:46:52.558 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- location_id: dr4vs1mpgc4v Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:52.558 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID dr4vs1mpgc4v Interval 值分布 ---
2025-04-21 20:46:52.560 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
35063   1    100.0
2025-04-21 20:46:52.561 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID dr4vs1mpgc4v Interval' 值计数中未发现 NaN。
2025-04-21 20:46:52.561 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID dr4vs1mpgc4v Interval' 唯一值数量 (含 NaN): 1
2025-04-21 20:46:52.561 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:52.780 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- location_id: gcpuvr295zcd Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:52.781 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID gcpuvr295zcd Interval 值分布 ---
2025-04-21 20:46:52.783 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
1       2    66.67
35061   1    33.33
2025-04-21 20:46:52.784 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID gcpuvr295zcd Interval' 值计数中未发现 NaN。
2025-04-21 20:46:52.784 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID gcpuvr295zcd Interval' 唯一值数量 (含 NaN): 2
2025-04-21 20:46:52.784 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:52.785 | WARNING  | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:344 -  location_id 'gcpuvr295zcd' has multiple time intervals detected in sample.
2025-04-21 20:46:53.002 | INFO     | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:340 - --- location_id: gcpvj6btgb1d Timestamp Interval Frequency (Pandas Sample) ---
2025-04-21 20:46:53.003 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:185 - --- 分析列：ID gcpvj6btgb1d Interval 值分布 ---
2025-04-21 20:46:53.005 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:263 - 值分布 (含 NaN):
       计数  百分比 (%)
count             
1       2    66.67
35061   1    33.33
2025-04-21 20:46:53.006 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:289 - 列 'ID gcpvj6btgb1d Interval' 值计数中未发现 NaN。
2025-04-21 20:46:53.006 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:292 - 列 'ID gcpvj6btgb1d Interval' 唯一值数量 (含 NaN): 2
2025-04-21 20:46:53.007 | INFO     | electricitydemand.utils.eda_utils:log_value_counts:293 - --------------------
2025-04-21 20:46:53.007 | WARNING  | electricitydemand.utils.eda_utils:analyze_timestamp_frequency_pandas:344 -  location_id 'gcpvj6btgb1d' has multiple time intervals detected in sample.
2025-04-21 20:46:53.008 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_timeseries_sample:400 - Weather time series frequency sample analysis complete.
2025-04-21 20:46:53.008 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:261 - --- 分析 Weather 数值特征相关性 (Spark) ---
2025-04-21 20:46:53.008 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:286 - 计算以下列的相关性: temperature_2m, relative_humidity_2m, dew_point_2m, apparent_temperature, precipitation, rain, snowfall, snow_depth, pressure_msl, surface_pressure, cloud_cover, cloud_cover_low, cloud_cover_mid, cloud_cover_high, et0_fao_evapotranspiration, vapour_pressure_deficit, wind_speed_10m, wind_direction_10m, wind_gusts_10m, soil_temperature_0_to_7cm, soil_moisture_0_to_7cm, sunshine_duration, shortwave_radiation, direct_radiation, diffuse_radiation, direct_normal_irradiance, terrestrial_radiation
2025-04-21 20:47:01.795 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:320 - Weather Feature Correlation Matrix saved: /home/ubuntu/ElectricityDemand/plots/weather_correlation_matrix.png
2025-04-21 20:47:01.803 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:332 - --- Strong Correlations (|corr| > 0.8) ---
2025-04-21 20:47:01.803 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:333 - apparent_temperature        temperature_2m                0.988910
precipitation               rain                          0.986577
shortwave_radiation         direct_radiation              0.964157
temperature_2m              soil_temperature_0_to_7cm     0.956536
soil_temperature_0_to_7cm   apparent_temperature          0.948871
et0_fao_evapotranspiration  shortwave_radiation           0.944134
direct_radiation            direct_normal_irradiance      0.922058
                            et0_fao_evapotranspiration    0.920355
wind_gusts_10m              wind_speed_10m                0.910252
shortwave_radiation         terrestrial_radiation         0.909390
terrestrial_radiation       diffuse_radiation             0.902464
shortwave_radiation         direct_normal_irradiance      0.893868
direct_normal_irradiance    sunshine_duration             0.891042
apparent_temperature        dew_point_2m                  0.858306
terrestrial_radiation       et0_fao_evapotranspiration    0.857942
cloud_cover_low             cloud_cover                   0.817122
shortwave_radiation         sunshine_duration             0.815321
et0_fao_evapotranspiration  direct_normal_irradiance      0.813937
dew_point_2m                temperature_2m                0.813515
2025-04-21 20:47:01.804 | INFO     | electricitydemand.eda.analyze_weather:analyze_weather_correlation:339 - --- 完成 Weather 数值特征相关性分析 ---
2025-04-21 20:47:01.804 | INFO     | __main__:run_all_eda:181 - --- 完成 Weather 分析 (Spark) ---
2025-04-21 20:47:01.804 | INFO     | __main__:run_all_eda:184 - --- 步骤 3: 关系分析 ---
2025-04-21 20:47:01.804 | INFO     | __main__:run_all_eda:187 - --- 开始 Demand vs building_class 分析 (Spark->Pandas) ---
2025-04-21 20:47:01.804 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_metadata:167 - --- 开始分析 Demand vs building_class 关系 (抽样比例: 0.1%) ---
2025-04-21 20:47:01.804 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:49 - Merging Spark demand sample (frac=0.001) with Pandas metadata columns: ['building_class']
2025-04-21 20:47:01.805 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:78 - Sampling Spark DataFrame (fraction=0.001)...
2025-04-21 20:47:01.811 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:85 - Converting Spark sample to Pandas...
2025-04-21 20:47:02.687 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:88 - Pandas sample size: 238296
2025-04-21 20:47:02.751 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:135 - Demand sample merge took 0.95 seconds. Result shape: (238296, 3)
2025-04-21 20:47:02.771 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_metadata:193 - 绘制 Demand (y) vs building_class 对比箱线图...
2025-04-21 20:47:03.341 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_building_class_boxplot_orig.png
2025-04-21 20:47:03.878 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_building_class_boxplot_log1p.png
2025-04-21 20:47:03.879 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_metadata:208 - Demand vs building_class 分析完成。
2025-04-21 20:47:03.881 | INFO     | __main__:run_all_eda:191 - --- 完成 Demand vs building_class 分析 ---
2025-04-21 20:47:03.882 | INFO     | __main__:run_all_eda:194 - --- 开始 Demand vs location 分析 (Spark->Pandas) ---
2025-04-21 20:47:03.882 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_location:232 - --- 开始分析 Demand vs location 关系 (Top 5, 抽样比例: 0.1%) ---
2025-04-21 20:47:03.885 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:49 - Merging Spark demand sample (frac=0.001) with Pandas metadata columns: ['location']
2025-04-21 20:47:03.885 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:78 - Sampling Spark DataFrame (fraction=0.001)...
2025-04-21 20:47:03.913 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:85 - Converting Spark sample to Pandas...
2025-04-21 20:47:04.462 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:88 - Pandas sample size: 238296
2025-04-21 20:47:04.515 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:135 - Demand sample merge took 0.63 seconds. Result shape: (238296, 3)
2025-04-21 20:47:04.528 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_location:269 - Top 5 locations (by data points in sample): ['London, UK', 'PT', 'Washington DC, USA', 'Missing', 'Minneapolis, Minnesota, USA']
2025-04-21 20:47:04.542 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_location:279 - 绘制 Demand (y) vs Top 5 location 对比箱线图...
2025-04-21 20:47:05.015 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_top5_location_boxplot_orig.png
2025-04-21 20:47:05.369 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_top5_location_boxplot_log1p.png
2025-04-21 20:47:05.369 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_location:294 - Demand vs location analysis complete.
2025-04-21 20:47:05.371 | INFO     | __main__:run_all_eda:197 - --- 完成 Demand vs location 分析 ---
2025-04-21 20:47:05.371 | INFO     | __main__:run_all_eda:200 - --- 开始 Demand vs dataset 分析 (Spark->Pandas) ---
2025-04-21 20:47:05.371 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_dataset:484 - --- Starting analysis of Demand vs dataset relationship (sample fraction: 0.1%) ---
2025-04-21 20:47:05.371 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:49 - Merging Spark demand sample (frac=0.001) with Pandas metadata columns: ['dataset']
2025-04-21 20:47:05.371 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:78 - Sampling Spark DataFrame (fraction=0.001)...
2025-04-21 20:47:05.378 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:85 - Converting Spark sample to Pandas...
2025-04-21 20:47:05.961 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:88 - Pandas sample size: 238296
2025-04-21 20:47:06.006 | INFO     | electricitydemand.eda.analyze_relationships:merge_demand_metadata_sample:135 - Demand sample merge took 0.64 seconds. Result shape: (238296, 3)
2025-04-21 20:47:06.043 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_dataset:515 - 'y' descriptive statistics grouped by dataset (based on 0.1% sample):
2025-04-21 20:47:06.045 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_dataset:519 - 
                              count        mean         std     min       25%        50%         75%        max
dataset                                                                                                        
Building Data Genome 2      25235.0  145.378218  273.377527  0.0001  19.30000  59.220000  154.500050   8351.600
Electricity Load Diagrams   41793.0  163.670128  865.775699  0.0000  15.36643  34.953112   90.648148  40825.000
London Smart Meter Data    168190.0    0.211977    0.297005  0.0000   0.05800   0.117000    0.238000      7.048
2025-04-21 20:47:06.046 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_dataset:526 - Plotting Demand (y) vs dataset comparison box plot...
2025-04-21 20:47:06.569 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_dataset_boxplot_orig.png
2025-04-21 20:47:07.129 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/demand_vs_dataset_boxplot_log1p.png
2025-04-21 20:47:07.130 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_dataset:542 - --- Demand vs dataset analysis took 1.76 seconds ---
2025-04-21 20:47:07.131 | INFO     | __main__:run_all_eda:203 - --- 完成 Demand vs dataset 分析 ---
2025-04-21 20:47:07.131 | INFO     | __main__:run_all_eda:206 - --- 开始 Demand vs Weather 分析 (Spark Join -> Pandas Collect) ---
2025-04-21 20:47:07.131 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:323 - --- Starting analysis of Demand vs Weather relationship (sampling 50 unique_ids) ---
2025-04-21 20:47:07.132 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:329 - Selecting random sample of unique IDs...
2025-04-21 20:47:07.132 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:338 - Selected 50 unique IDs for analysis.
2025-04-21 20:47:07.132 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:341 - Filtering demand data for selected IDs...
2025-04-21 20:47:07.184 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:347 - Aligning demand timestamps to the hour...
2025-04-21 20:47:07.193 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:354 - Joining sampled demand data with metadata to get location_id...
2025-04-21 20:47:07.303 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:368 - Aligning weather timestamps to the hour and selecting relevant columns...
2025-04-21 20:47:07.326 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:400 - Joining aligned demand+location with aligned weather data using Spark...
2025-04-21 20:47:07.337 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:411 - Collecting the merged data (50 IDs) to Pandas DataFrame for correlation analysis...
2025-04-21 20:47:10.291 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:416 - Collected 1,476,583 rows into Pandas.
2025-04-21 20:47:10.545 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:445 - Correlation matrix between demand (y) and weather features:
y                       1.000000
temperature_2m          0.384095
relative_humidity_2m   -0.369590
apparent_temperature    0.373106
precipitation          -0.002845
wind_speed_10m         -0.120949
cloud_cover            -0.245019
2025-04-21 20:47:10.545 | INFO     | electricitydemand.eda.analyze_relationships:analyze_demand_vs_weather:461 - --- Demand vs Weather analysis took 3.41 seconds ---
2025-04-21 20:47:10.554 | INFO     | __main__:run_all_eda:215 - --- 完成 Demand vs Weather 分析 ---
2025-04-21 20:47:10.555 | INFO     | __main__:run_all_eda:221 - --- 步骤 4: 时间特征分析 (Spark) ---
2025-04-21 20:47:10.555 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:23 - --- 开始分析时间戳一致性 (Spark) ---
2025-04-21 20:47:10.555 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:27 - 分析 Demand 数据时间戳间隔...
2025-04-21 20:47:10.611 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:41 - 对 Demand 时间差进行抽样 (比例: 0.001) 以统计频率...
2025-04-21 20:47:21.215 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:59 - Demand 数据中最常见的 10 个时间间隔 (秒):
2025-04-21 20:47:21.216 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:60 - 
 diff_seconds  count
         1800 168711
          900  41998
         3600  27967
2025-04-21 20:47:21.216 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:65 - Demand 数据中最常见的 10 个时间间隔 (易读格式):
2025-04-21 20:47:21.218 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:66 - 
       interval  count
0 days 00:30:00 168711
0 days 00:15:00  41998
0 days 01:00:00  27967
2025-04-21 20:47:21.218 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:82 - 分析 Weather 数据时间戳间隔...
2025-04-21 20:47:21.282 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:97 - 对 Weather 时间差进行抽样 (比例: 0.001) 以统计频率...
2025-04-21 20:47:22.173 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:113 - Weather 数据中最常见的 10 个时间间隔 (秒):
2025-04-21 20:47:22.174 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:114 - 
 diff_seconds  count
         3600    612
2025-04-21 20:47:22.174 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:119 - Weather 数据中最常见的 10 个时间间隔 (易读格式):
2025-04-21 20:47:22.176 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:120 - 
       interval  count
0 days 01:00:00    612
2025-04-21 20:47:22.176 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:125 - Weather 数据的主要时间间隔确认为 1 小时。
2025-04-21 20:47:22.176 | INFO     | electricitydemand.eda.analyze_time:analyze_timestamp_consistency:143 - --- 完成分析时间戳一致性 ---
2025-04-21 20:47:22.176 | INFO     | electricitydemand.eda.analyze_time:analyze_datetime_features_spark:154 - --- 开始分析日期时间特征 (Spark) ---
2025-04-21 20:47:22.196 | INFO     | electricitydemand.eda.analyze_time:analyze_datetime_features_spark:175 - 计算每小时的平均电力需求...
2025-04-21 20:47:23.562 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:23.566 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:23.769 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/avg_demand_by_hour_spark.png
2025-04-21 20:47:23.770 | INFO     | electricitydemand.eda.analyze_time:analyze_datetime_features_spark:197 - 计算每周中每天的平均电力需求...
2025-04-21 20:47:25.540 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:25.543 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:25.622 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/avg_demand_by_dayofweek_spark.png
2025-04-21 20:47:25.622 | INFO     | electricitydemand.eda.analyze_time:analyze_datetime_features_spark:230 - 计算每月平均电力需求...
2025-04-21 20:47:27.192 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:27.196 | INFO     | logging:callHandlers:1762 - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-04-21 20:47:27.326 | INFO     | electricitydemand.utils.eda_utils:save_plot:29 - Plot saved to: /home/ubuntu/ElectricityDemand/plots/avg_demand_by_month_spark.png
2025-04-21 20:47:27.327 | INFO     | electricitydemand.eda.analyze_time:analyze_datetime_features_spark:267 - --- 完成分析日期时间特征 ---
2025-04-21 20:47:27.327 | INFO     | __main__:run_all_eda:224 - --- 完成 时间特征分析 ---
2025-04-21 20:47:27.327 | INFO     | __main__:run_all_eda:227 - --- 步骤 5: 数据质量检查总结 (Spark) ---
2025-04-21 20:47:27.327 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:42 - --- 开始检查 Demand DataFrame 缺失值 (Spark) ---
2025-04-21 20:47:27.771 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:44 - Demand 总行数: 237,944,171
2025-04-21 20:47:28.476 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Demand - 列 'unique_id' 无缺失值
2025-04-21 20:47:28.476 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Demand - 列 'timestamp' 无缺失值
2025-04-21 20:47:28.476 | WARNING  | electricitydemand.eda.data_quality:check_missing_values_spark:104 - Demand - 列 'y' 缺失值数量: 3,086,278 (1.30%)
2025-04-21 20:47:28.476 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:42 - --- 开始检查 Metadata DataFrame 缺失值 (Spark) ---
2025-04-21 20:47:28.502 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:44 - Metadata 总行数: 7,572
2025-04-21 20:47:28.652 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'unique_id' 无缺失值
2025-04-21 20:47:28.652 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'dataset' 无缺失值
2025-04-21 20:47:28.652 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'building_id' 无缺失值
2025-04-21 20:47:28.652 | WARNING  | electricitydemand.eda.data_quality:check_missing_values_spark:104 - Metadata - 列 'location_id' 缺失值数量: 237 (3.13%)
2025-04-21 20:47:28.652 | WARNING  | electricitydemand.eda.data_quality:check_missing_values_spark:104 - Metadata - 列 'latitude' 缺失值数量: 237 (3.13%)
2025-04-21 20:47:28.652 | WARNING  | electricitydemand.eda.data_quality:check_missing_values_spark:104 - Metadata - 列 'longitude' 缺失值数量: 237 (3.13%)
2025-04-21 20:47:28.653 | WARNING  | electricitydemand.eda.data_quality:check_missing_values_spark:104 - Metadata - 列 'location' 缺失值数量: 237 (3.13%)
2025-04-21 20:47:28.653 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'timezone' 无缺失值
2025-04-21 20:47:28.653 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'building_class' 无缺失值
2025-04-21 20:47:28.653 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'cluster_size' 无缺失值
2025-04-21 20:47:28.653 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Metadata - 列 'freq' 无缺失值
2025-04-21 20:47:28.653 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:42 - --- 开始检查 Weather DataFrame 缺失值 (Spark) ---
2025-04-21 20:47:28.764 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:44 - Weather 总行数: 604,848
2025-04-21 20:47:29.521 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'timestamp' 无缺失值
2025-04-21 20:47:29.521 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'temperature_2m' 无缺失值
2025-04-21 20:47:29.521 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'relative_humidity_2m' 无缺失值
2025-04-21 20:47:29.521 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'dew_point_2m' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'apparent_temperature' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'precipitation' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'rain' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'snowfall' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'snow_depth' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'weather_code' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'pressure_msl' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'surface_pressure' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'cloud_cover' 无缺失值
2025-04-21 20:47:29.522 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'cloud_cover_low' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'cloud_cover_mid' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'cloud_cover_high' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'et0_fao_evapotranspiration' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'vapour_pressure_deficit' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'wind_speed_10m' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'wind_direction_10m' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'wind_gusts_10m' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'soil_temperature_0_to_7cm' 无缺失值
2025-04-21 20:47:29.523 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'soil_temperature_7_to_28cm' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'soil_moisture_0_to_7cm' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'soil_moisture_7_to_28cm' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'is_day' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'sunshine_duration' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'shortwave_radiation' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'direct_radiation' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'diffuse_radiation' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'direct_normal_irradiance' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'terrestrial_radiation' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:109 - Weather - 列 'location_id' 无缺失值
2025-04-21 20:47:29.524 | INFO     | electricitydemand.eda.data_quality:check_missing_values_spark:119 - Weather 中未发现缺失值。
2025-04-21 20:47:29.525 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:137 - --- 开始检查 Demand DataFrame 中基于 ['unique_id', 'timestamp'] 的重复行 (Spark) ---
2025-04-21 20:47:37.997 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:188 - 在 Demand 中未发现基于 ['unique_id', 'timestamp'] 的重复行。
2025-04-21 20:47:38.006 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:203 - --- 完成 Demand DataFrame 重复行检查 ---
2025-04-21 20:47:38.007 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:137 - --- 开始检查 Metadata DataFrame 中基于 ['unique_id'] 的重复行 (Spark) ---
2025-04-21 20:47:38.178 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:188 - 在 Metadata 中未发现基于 ['unique_id'] 的重复行。
2025-04-21 20:47:38.181 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:203 - --- 完成 Metadata DataFrame 重复行检查 ---
2025-04-21 20:47:38.182 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:137 - --- 开始检查 Weather DataFrame 中基于 ['location_id', 'timestamp'] 的重复行 (Spark) ---
2025-04-21 20:47:39.078 | WARNING  | electricitydemand.eda.data_quality:check_duplicates_spark:176 - 在 Weather 中发现基于 ['location_id', 'timestamp'] 的重复数据:
2025-04-21 20:47:39.079 | WARNING  | electricitydemand.eda.data_quality:check_duplicates_spark:177 -   - 唯一重复组合的数量: 6
2025-04-21 20:47:39.080 | WARNING  | electricitydemand.eda.data_quality:check_duplicates_spark:178 -   - 涉及的总行数（包括首次出现）: 12
2025-04-21 20:47:39.080 | WARNING  | electricitydemand.eda.data_quality:check_duplicates_spark:179 -   - '额外'的重复行数（需移除）: 6
2025-04-21 20:47:39.083 | INFO     | electricitydemand.eda.data_quality:check_duplicates_spark:203 - --- 完成 Weather DataFrame 重复行检查 ---
2025-04-21 20:47:39.084 | INFO     | __main__:run_all_eda:236 - --- 完成 数据质量检查 ---
2025-04-21 20:47:39.084 | INFO     | __main__:run_all_eda:238 - ========================================
2025-04-21 20:47:39.084 | INFO     | __main__:run_all_eda:239 - === EDA (包含补充分析) 执行成功完成 ===
2025-04-21 20:47:39.084 | INFO     | __main__:run_all_eda:240 - ========================================
2025-04-21 20:47:39.086 | INFO     | electricitydemand.utils.project_utils:stop_spark_session:195 - Stopping SparkSession...
2025-04-21 20:47:40.859 | SUCCESS  | electricitydemand.utils.project_utils:stop_spark_session:197 - SparkSession stopped.
2025-04-21 20:47:40.860 | INFO     | __main__:run_all_eda:256 - --- EDA 脚本总执行时间: 357.29 秒 ---
